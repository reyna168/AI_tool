<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ‰ å°¾ç‰™ 5x5 è³“æœéŠæˆ² ğŸ‰</title>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&display=swap');

        :root {
            --primary-color: #e94e77; /* ç¯€æ…¶ç²‰ç´… */
            --secondary-color: #55a630; /* è³“æœç¶  */
            --background-color: #f7f7f7;
            --card-background: #ffffff;
            --marked-color: #ffc300; /* æ¨™è¨˜äº®é»ƒ */
        }

        body {
            font-family: 'Noto Sans TC', sans-serif;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background-color: var(--background-color);
            padding: 20px;
            font-size: 1.1em;
            color: #333;
        }

        .container {
            background: var(--card-background);
            padding: 30px 40px;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
            width: 95%;
            max-width: 700px;
            border: 4px solid var(--primary-color);
            margin-bottom: 20px;
            text-align: center;
        }

        h1 {
            color: var(--primary-color);
            font-size: 2.5em;
            font-weight: 900;
            margin-bottom: 10px;
            text-shadow: 1px 1px 0 #fff;
        }

        /* --- è³“æœç›¤æ¨£å¼ --- */
        #bingoBoard {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 5px;
            width: 100%;
            aspect-ratio: 1 / 1; /* ä¿æŒæ­£æ–¹å½¢ */
            margin: 20px auto;
            border: 2px solid var(--secondary-color);
            padding: 5px;
            border-radius: 10px;
        }

        .bingo-cell {
            background-color: #e8f5e9; /* æ·ºç¶ åº• */
            color: #333;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.8em; /* æ•¸å­—æ”¾å¤§ */
            font-weight: 700;
            border-radius: 8px;
            cursor: pointer;
            user-select: none;
            transition: all 0.2s ease;
            border: 2px solid var(--secondary-color);
        }

        .bingo-cell:hover:not(.marked) {
            background-color: #c8e6c9;
        }

        .bingo-cell.marked {
            background-color: var(--marked-color);
            color: #333;
            border: 2px solid #ffaa00;
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.2);
            transform: scale(0.95);
        }
        
        /* ä¸­é–“çš„ Free Space */
        .bingo-cell:nth-child(13) { 
            background-color: var(--primary-color);
            color: white;
            font-size: 1.2em;
            font-weight: 900;
            cursor: default;
        }
        
        /* å«è™Ÿå€ */
        #callStatus {
            margin: 20px 0;
            padding: 15px;
            background-color: #fff3e0;
            border-radius: 10px;
            border: 2px dashed var(--primary-color);
        }

        #currentNumber {
            font-size: 3em;
            color: var(--primary-color);
            font-weight: 900;
            display: block;
            margin: 5px 0 10px;
            animation: zoomIn 0.5s ease-out;
        }
        
        #calledNumbersList {
            font-size: 0.9em;
            color: #555;
            max-height: 100px;
            overflow-y: auto;
            padding: 5px;
            border-top: 1px solid #eee;
            margin-top: 10px;
        }

        /* æŒ‰éˆ•æ¨£å¼ */
        button {
            background-color: var(--secondary-color);
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 700;
            margin: 5px;
            transition: background-color 0.3s, transform 0.1s;
            box-shadow: 0 4px 0 #388e3c;
        }

        button:hover {
            background-color: #388e3c;
            transform: translateY(1px);
            box-shadow: 0 3px 0 #2e7d32;
        }
        
        #nextCallButton {
             background-color: var(--primary-color);
             box-shadow: 0 4px 0 #d84315;
        }
        #nextCallButton:hover {
             background-color: #d84315;
             box-shadow: 0 3px 0 #bf360c;
        }

        .bingo-win {
            color: var(--primary-color);
            font-size: 2em;
            font-weight: 900;
            margin-top: 20px;
            animation: pulse 1s infinite;
        }
        
        .hidden {
            display: none;
        }
        
        /* å‹•ç•« */
        @keyframes zoomIn {
            from { transform: scale(0.5); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @media (max-width: 500px) {
            .container {
                padding: 20px;
            }
            .bingo-cell {
                font-size: 1.5em;
            }
            #currentNumber {
                font-size: 2.5em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ‰ å°¾ç‰™ 5x5 è³“æœéŠæˆ² ğŸ‰</h1>
        
        <div id="callStatus">
            <h3>ç›®å‰å«è™Ÿï¼š<span id="currentNumber">--</span></h3>
            <p>å·²å«å‡ºæ•¸å­—æ¸…å–®ï¼š</p>
            <div id="calledNumbersList">è«‹é»æ“Šé–‹å§‹éŠæˆ²ä¸¦å«è™Ÿ...</div>
        </div>

        <div id="controls">
            <button onclick="startGame()">é‡æ–°é–‹å§‹éŠæˆ²</button>
            <button id="nextCallButton" onclick="callNextNumber()">ğŸ² å«ä¸‹ä¸€å€‹è™Ÿç¢¼</button>
        </div>

        <div id="statusMessage" class="bingo-win hidden"></div>
    </div>
    
    <div class="container" style="max-width: 600px; margin-top: 0;">
        <h2 style="font-size: 1.5em; color: var(--secondary-color);">ä½ çš„è³“æœç›¤ (1~50)</h2>
        <div id="bingoBoard">
            </div>
        <p style="font-size: 0.9em; color: #777;">é»æ“Šæ‚¨çš„è³“æœç›¤ä¸Šèˆ‡å«è™Ÿç›¸ç¬¦çš„æ•¸å­—ä¾†æ¨™è¨˜å®ƒã€‚</p>
    </div>

    <script>
        // --- éŠæˆ²ç‹€æ…‹è®Šæ•¸ ---
        let bingoBoard = []; // ç©å®¶çš„è³“æœç›¤ (5x5 æ•¸å­—)
        let calledNumbers = []; // å·²å«å‡ºçš„æ•¸å­—åˆ—è¡¨
        let markedCells = Array(5).fill(0).map(() => Array(5).fill(false)); // æ¨™è¨˜ç‹€æ…‹ (5x5 å¸ƒæ—å€¼)
        const TOTAL_NUMBERS = 50; // è³“æœç›¤ä½¿ç”¨çš„æ•¸å­—ç¯„åœ (1~50)
        let gameActive = false;

        // --- DOM å…ƒç´  ---
        const boardElement = document.getElementById('bingoBoard');
        const currentNumberElement = document.getElementById('currentNumber');
        const calledNumbersListElement = document.getElementById('calledNumbersList');
        const statusMessageElement = document.getElementById('statusMessage');
        const nextCallButton = document.getElementById('nextCallButton');

        /**
         * 1. åˆå§‹åŒ–ä¸¦ç”Ÿæˆç©å®¶çš„ 5x5 è³“æœç›¤
         */
        function generateBoard() {
            // ç”¢ç”Ÿ 25 å€‹ä¸é‡è¤‡çš„éš¨æ©Ÿæ•¸å­— (1 åˆ° 50)
            const allNumbers = Array.from({ length: TOTAL_NUMBERS }, (_, i) => i + 1);
            allNumbers.sort(() => 0.5 - Math.random()); // äº‚åº
            const boardNumbers = allNumbers.slice(0, 25);
            
            bingoBoard = [];
            let k = 0;
            for (let i = 0; i < 5; i++) {
                bingoBoard[i] = [];
                for (let j = 0; j < 5; j++) {
                    bingoBoard[i][j] = boardNumbers[k++];
                }
            }
            
            // è¨­å®šä¸­å¿ƒç‚º Free Space
            // bingoBoard[2][2] = 'FREE'; 
        }

        /**
         * 2. åœ¨ç¶²é ä¸Šç¹ªè£½è³“æœç›¤
         */
        function renderBoard() {
            boardElement.innerHTML = ''; // æ¸…ç©ºèˆŠç›¤é¢
            for (let i = 0; i < 5; i++) {
                for (let j = 0; j < 5; j++) {
                    const cell = document.createElement('div');
                    const number = bingoBoard[i][j];
                    
                    cell.textContent = (i === 2 && j === 2) ? 'FREE' : number;
                    cell.className = 'bingo-cell';
                    cell.dataset.row = i;
                    cell.dataset.col = j;
                    cell.dataset.number = number;
                    
                    // ç‰¹æ®Šè™•ç†ä¸­å¿ƒ Free Space
                    if (i === 2 && j === 2) {
                        cell.classList.add('marked'); // é è¨­æ¨™è¨˜
                        markedCells[i][j] = true;
                    } else {
                        cell.onclick = () => markCell(i, j, number);
                        if (markedCells[i][j]) {
                            cell.classList.add('marked');
                        }
                    }
                    boardElement.appendChild(cell);
                }
            }
        }

        /**
         * 3. éŠæˆ²å•Ÿå‹•/é‡ç½®
         */
        function startGame() {
            generateBoard();
            calledNumbers = [];
            markedCells = Array(5).fill(0).map(() => Array(5).fill(false));
            markedCells[2][2] = true; // Free Space é è¨­æ¨™è¨˜
            gameActive = true;

            renderBoard();
            currentNumberElement.textContent = '--';
            calledNumbersListElement.textContent = 'éŠæˆ²å·²é‡ç½®ã€‚è«‹å«è™Ÿï¼';
            statusMessageElement.classList.add('hidden');
            nextCallButton.disabled = false;
        }

        /**
         * 4. å«ä¸‹ä¸€å€‹éš¨æ©Ÿè™Ÿç¢¼
         */
        function callNextNumber() {
            if (!gameActive) {
                alert('è«‹å…ˆé»æ“Š "é‡æ–°é–‹å§‹éŠæˆ²"ï¼');
                return;
            }

            if (calledNumbers.length >= TOTAL_NUMBERS) {
                currentNumberElement.textContent = 'éŠæˆ²çµæŸï¼';
                nextCallButton.disabled = true;
                return;
            }

            let nextNumber;
            // éš¨æ©Ÿé¸ä¸€å€‹å°šæœªè¢«å«éçš„æ•¸å­—
            do {
                nextNumber = Math.floor(Math.random() * TOTAL_NUMBERS) + 1;
            } while (calledNumbers.includes(nextNumber));

            calledNumbers.push(nextNumber);
            currentNumberElement.textContent = nextNumber;
            
            // æ›´æ–°å·²å«å‡ºæ•¸å­—åˆ—è¡¨
            const sortedList = [...calledNumbers].sort((a, b) => a - b);
            calledNumbersListElement.innerHTML = sortedList.map(num => `<span>${num}</span>`).join(', ');
            calledNumbersListElement.scrollTop = calledNumbersListElement.scrollHeight; // è‡ªå‹•æ²åˆ°åº•éƒ¨
        }

        /**
         * 5. æ¨™è¨˜ç©å®¶è³“æœç›¤ä¸Šçš„æ•¸å­—
         */
        function markCell(row, col, number) {
            if (!gameActive) return;
            
            // æª¢æŸ¥è©²æ•¸å­—æ˜¯å¦å·²ç¶“è¢«å«å‡º
            if (!calledNumbers.includes(number)) {
                showMessage(`âš ï¸ ${number} å°šæœªè¢«å«å‡ºï¼`, 'hint');
                return;
            }
            
            if (markedCells[row][col]) {
                showMessage(`âœ… ${number} å·²ç¶“æ¨™è¨˜éäº†ï¼`, 'hint');
                return;
            }
            
            // æ¨™è¨˜æˆåŠŸ
            markedCells[row][col] = true;
            const cell = boardElement.querySelector(`[data-row="${row}"][data-col="${col}"]`);
            cell.classList.add('marked');
            
            // æª¢æŸ¥æ˜¯å¦è³“æœ
            if (checkForBingo()) {
                endGame();
            } else {
                showMessage(`ğŸ‘ æˆåŠŸæ¨™è¨˜æ•¸å­— ${number}ï¼ç¹¼çºŒï¼`, 'success');
            }
        }

        /**
         * 6. æª¢æŸ¥è³“æœç²å‹æ¢ä»¶
         */
        function checkForBingo() {
            const size = 5;
            let bingoCount = 0; // è¨ˆç®—æœ‰å¹¾æ¢ç·šé€£ç·š
            
            // æª¢æŸ¥æ©«æ’å’Œç›´è¡Œ
            for (let i = 0; i < size; i++) {
                // æª¢æŸ¥æ©«æ’
                if (markedCells[i].every(cell => cell)) {
                    bingoCount++;
                }
                // æª¢æŸ¥ç›´è¡Œ
                if (markedCells.every(row => row[i])) {
                    bingoCount++;
                }
            }
            
            // æª¢æŸ¥å…©æ¢å°è§’ç·š
            let diag1 = true; // å·¦ä¸Šåˆ°å³ä¸‹
            let diag2 = true; // å³ä¸Šåˆ°å·¦ä¸‹
            for (let i = 0; i < size; i++) {
                if (!markedCells[i][i]) diag1 = false;
                if (!markedCells[i][size - 1 - i]) diag2 = false;
            }
            if (diag1) bingoCount++;
            if (diag2) bingoCount++;

            // è³“æœé€šå¸¸æ˜¯æŒ‡é€£æˆä¸€æ¢ç·šå³å¯ï¼Œå¦‚æœéœ€è¦å¤šæ¢ç·šé€£ç·šï¼Œä¿®æ”¹æ­¤è™•å³å¯
            return bingoCount >= 1; 
        }

        /**
         * 7. éŠæˆ²çµæŸ
         */
        function endGame() {
            gameActive = false;
            nextCallButton.disabled = true;
            statusMessageElement.textContent = 'ğŸ‰ è³“æœï¼æ­å–œç²å‹è€…ï¼è«‹ä¸Šå°é ˜çï¼ ğŸ‰';
            statusMessageElement.classList.remove('hidden');
            
            // ç§»é™¤æ‰€æœ‰æ ¼å­çš„é»æ“Šäº‹ä»¶
            const allCells = boardElement.querySelectorAll('.bingo-cell');
            allCells.forEach(cell => {
                cell.onclick = null;
                cell.style.cursor = 'default';
            });
        }
        
        /**
         * é¡¯ç¤ºæç¤ºè¨Šæ¯ (ç”¨æ–¼æ¨™è¨˜æ™‚çš„å›é¥‹)
         */
        function showMessage(text, type) {
            // ç°¡å–®åœ°å°‡è¨Šæ¯é¡¯ç¤ºåœ¨ç‹€æ…‹å€
            console.log(text); 
            // å¦‚æœéœ€è¦ï¼Œå¯ä»¥åœ¨ç¶²é ä¸Šç‰¹å®šä½ç½®é¡¯ç¤ºå¿«é–ƒè¨Šæ¯
        }

        // é é¢è¼‰å…¥æ™‚è‡ªå‹•é–‹å§‹éŠæˆ²
        window.onload = startGame;
    </script>
</body>
</html>